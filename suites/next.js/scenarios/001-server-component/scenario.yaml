id: ZE_nextjs_server_component
suite: next.js
title: "Server Component Data Fetching"
description: |
  This evaluation tests the ability to implement server-side data fetching using React Server Components (RSC) in Next.js App Router. This is a fundamental pattern for building performant, SEO-friendly applications.

workspace:
  node: "20.x"
  manager: auto
  managers_allowed: [pnpm]
  workspaces: pnpm

baseline:
  run:
    - cmd: "pnpm install"
    - cmd: "pnpm build"
    - cmd: "pnpm lint"
    - cmd: "pnpm test"

validation:
  commands:
    install: "pnpm install"
    test: "pnpm test"
    lint: "pnpm lint"

oracle:
  answers_file: "./oracle-answers.json"

heuristic_checks:
  enabled: true

  # Critical validation commands
  commands:
    - name: "install_succeeds"
      command: "pnpm install"
      weight: 2.0
      description: "Dependencies install successfully"

    - name: "build_succeeds"
      command: "pnpm build"
      weight: 3.0
      description: "Production build completes without errors"


    - name: "lint_passes"
      command: "pnpm lint"
      weight: 1.0
      description: "Code meets linting standards"

  # Check for Server Component patterns
  patterns:
    - name: "has_async_component"
      file: "app/**/*.tsx"
      pattern: "export default async function|async function.*Component"
      weight: 2.5
      description: "Server component uses async pattern"

    - name: "has_server_data_fetch"
      file: "app/**/*.tsx"
      pattern: "await fetch|await.*\\(\\)"
      weight: 2.0
      description: "Server-side data fetching implemented"

    - name: "no_client_hooks_in_server"
      file: "app/**/page.tsx"
      pattern: "useState|useEffect|useContext|useReducer"
      weight: 2.0
      description: "No client-side hooks in server components"

    - name: "proper_component_structure"
      file: "app/**/*.tsx"
      pattern: "export default|function.*\\(.*props"
      weight: 1.0
      description: "Components follow proper structure"

    - name: "has_typescript_types"
      file: "app/**/*.tsx"
      pattern: "interface|type\\s+\\w+.*="
      weight: 0.5
      description: "TypeScript types defined"

llm_judge:
  enabled: true
  model: "anthropic/claude-3.5-sonnet"
  temperature: 0.1
  max_tokens: 2000
  categories:
    - "Server Component Implementation (Weight: 35%): Correct async component, proper data fetching without client-side hooks. Score 1-5: 1=uses client hooks incorrectly, 5=perfect RSC"
    - "Data Fetching Patterns (Weight: 30%): Efficient server-side data fetching, proper error handling, caching strategies. Score 1-5: 1=inefficient/broken, 5=optimal patterns"
    - "Code Structure & Organization (Weight: 20%): Clean component structure, proper TypeScript types, separation of concerns. Score 1-5: 1=messy code, 5=well-organized"
    - "Performance & Best Practices (Weight: 10%): SEO-friendly, efficient rendering, no unnecessary client components. Score 1-5: 1=poor performance, 5=optimized"
    - "Overall Implementation Quality (Weight: 5%): Completeness, reliability, adherence to Next.js patterns. Score 1-5: 1=broken, 5=production-ready"
