{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://zephyr-benchmarks.dev/schemas/specialist-template.json",
  "title": "Specialist Template",
  "description": "Schema for AI specialist agent templates used in the Zephyr benchmarking system",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "name",
    "displayName",
    "version",
    "license",
    "availability",
    "maintainers",
    "persona",
    "capabilities",
    "dependencies",
    "documentation",
    "prompts"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference (usually './specialist-template.schema.json')",
      "format": "uri-reference"
    },
    "schema_version": {
      "type": "string",
      "description": "Version of the template schema",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["0.0.1"]
    },
    "name": {
      "type": "string",
      "description": "Internal identifier for the specialist (kebab-case, must include 'specialist' suffix)",
      "pattern": "^[a-z0-9]+(-[a-z0-9]+)*-specialist$",
      "examples": ["qa-web-specialist", "shadcn-specialist", "nextjs-specialist"]
    },
    "displayName": {
      "type": "string",
      "description": "Human-readable name displayed in UI",
      "minLength": 1,
      "examples": ["Web QA Expert", "shadcn/ui Expert", "Next.js App Router Expert"]
    },
    "version": {
      "type": "string",
      "description": "Template version (semantic versioning)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["0.0.1", "1.0.0"]
    },
    "license": {
      "type": "string",
      "description": "License for the template",
      "examples": ["MIT", "Apache-2.0", "BSD-3-Clause"]
    },
    "availability": {
      "type": "string",
      "description": "Template availability level",
      "enum": ["public", "internal", "private"]
    },
    "from": {
      "type": "string",
      "description": "Parent template to inherit from (optional, supports inheritance)",
      "examples": ["@quality-assurance/base", "./base-template.json5"]
    },
    "maintainers": {
      "type": "array",
      "description": "List of template maintainers",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["name", "email"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Maintainer name or team name"
          },
          "email": {
            "type": "string",
            "description": "Contact email",
            "format": "email"
          }
        }
      }
    },
    "persona": {
      "type": "object",
      "description": "Defines the specialist's personality, expertise, and approach",
      "required": ["purpose", "values", "attributes", "tech_stack"],
      "properties": {
        "purpose": {
          "type": "string",
          "description": "High-level description of the specialist's role and expertise"
        },
        "values": {
          "type": "array",
          "description": "Core values and principles the specialist follows",
          "minItems": 1,
          "items": {
            "type": "string"
          }
        },
        "attributes": {
          "type": "array",
          "description": "Key skills, expertise areas, and characteristics",
          "minItems": 1,
          "items": {
            "type": "string"
          }
        },
        "tech_stack": {
          "type": "array",
          "description": "Technologies, tools, and frameworks the specialist is proficient in",
          "minItems": 1,
          "items": {
            "type": "string"
          }
        }
      }
    },
    "capabilities": {
      "type": "object",
      "description": "Detailed breakdown of what the specialist can do",
      "required": ["tags", "descriptions"],
      "properties": {
        "tags": {
          "type": "array",
          "description": "Capability identifiers (kebab-case)",
          "minItems": 1,
          "items": {
            "type": "string",
            "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$"
          }
        },
        "descriptions": {
          "type": "object",
          "description": "Detailed descriptions for each capability tag",
          "additionalProperties": {
            "type": "string"
          }
        },
        "considerations": {
          "type": "array",
          "description": "Important considerations, caveats, and best practices",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "dependencies": {
      "type": "object",
      "description": "External dependencies and requirements",
      "required": ["subscription", "available_tools"],
      "properties": {
        "subscription": {
          "type": "object",
          "description": "Subscription requirements for external services",
          "required": ["required", "purpose"],
          "properties": {
            "required": {
              "type": "boolean",
              "description": "Whether a paid subscription is required"
            },
            "purpose": {
              "type": "string",
              "description": "Explanation of what the subscription is used for"
            }
          }
        },
        "available_tools": {
          "type": "array",
          "description": "Tools available to the specialist",
          "minItems": 1,
          "items": {
            "type": "string",
            "enum": [
              "file_system",
              "terminal",
              "code_analysis",
              "git",
              "web_fetch",
              "http_client",
              "contract_verifier",
              "service_virtualization",
              "test_runner",
              "container_runtime",
              "mobile_device_emulation",
              "figma",
              "maze",
              "usertesting",
              "confluence"
            ]
          }
        },
        "mcps": {
          "type": "array",
          "description": "Model Context Protocol (MCP) servers",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": {
                "type": "string",
                "description": "MCP server name"
              },
              "version": {
                "type": "string",
                "description": "Required version (semver range)",
                "examples": ["^1.0.0", ">=2.0.0"]
              },
              "permissions": {
                "type": "array",
                "description": "Required permissions",
                "items": {
                  "type": "string",
                  "enum": ["read", "write", "execute"]
                }
              },
              "description": {
                "type": "string",
                "description": "What this MCP server provides"
              },
              "required": {
                "type": "boolean",
                "description": "Whether this MCP server is required"
              }
            }
          }
        }
      }
    },
    "documentation": {
      "type": "array",
      "description": "Reference documentation for the specialist",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["type", "description"],
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of documentation",
            "enum": ["official", "reference", "control", "internal", "external"]
          },
          "url": {
            "type": "string",
            "description": "URL to external documentation",
            "format": "uri"
          },
          "path": {
            "type": "string",
            "description": "Path to local documentation file (relative to template)"
          },
          "description": {
            "type": "string",
            "description": "Brief description of what this documentation covers"
          }
        },
        "oneOf": [
          {
            "required": ["url"]
          },
          {
            "required": ["path"]
          }
        ]
      }
    },
    "preferred_models": {
      "type": "array",
      "description": "List of preferred AI models (in priority order)",
      "items": {
        "type": "object",
        "required": ["model"],
        "properties": {
          "model": {
            "type": "string",
            "description": "Model identifier",
            "examples": [
              "claude-sonnet-4.5",
              "claude-sonnet-3.5",
              "gpt-4o",
              "anthropic/claude-3.5-haiku",
              "openai/gpt-4o-mini"
            ]
          },
          "provider": {
            "type": "string",
            "description": "Model provider",
            "enum": ["anthropic", "openai", "openrouter"]
          },
          "reason": {
            "type": "string",
            "description": "Why this model is preferred for this specialist"
          }
        }
      }
    },
    "prompts": {
      "type": "object",
      "description": "Prompt configurations for different contexts and models",
      "required": ["default"],
      "properties": {
        "default": {
          "type": "object",
          "description": "Default prompts used as fallback",
          "required": ["spawnerPrompt"],
          "properties": {
            "spawnerPrompt": {
              "type": "string",
              "description": "Main system prompt that defines the specialist's behavior"
            }
          },
          "additionalProperties": {
            "type": "string",
            "description": "Additional prompt templates with Mustache-style variables"
          }
        },
        "model_specific": {
          "type": "object",
          "description": "Model-specific prompt overrides",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "spawnerPrompt": {
                "type": "string",
                "description": "Model-specific system prompt"
              }
            },
            "additionalProperties": {
              "type": "string",
              "description": "Model-specific prompt templates"
            }
          }
        },
        "prompt_strategy": {
          "type": "object",
          "description": "Strategy for prompt selection and interpolation",
          "properties": {
            "fallback": {
              "type": "string",
              "description": "Fallback prompt key when specific prompt not found",
              "default": "default"
            },
            "model_detection": {
              "type": "string",
              "description": "How to detect which model-specific prompts to use",
              "enum": ["auto", "manual", "disabled"],
              "default": "auto"
            },
            "allow_override": {
              "type": "boolean",
              "description": "Whether to allow runtime prompt overrides",
              "default": true
            },
            "interpolation": {
              "type": "object",
              "description": "Template interpolation settings",
              "properties": {
                "style": {
                  "type": "string",
                  "description": "Template syntax style",
                  "enum": ["mustache", "jinja2", "handlebars"],
                  "default": "mustache"
                },
                "escape_html": {
                  "type": "boolean",
                  "description": "Whether to escape HTML in interpolated values",
                  "default": false
                }
              }
            }
          }
        }
      },
      "additionalProperties": {
        "type": "object",
        "description": "Task-specific prompts (e.g., test_strategy, automation_setup, troubleshoot)",
        "properties": {
          "default": {
            "type": "object",
            "properties": {
              "systemPrompt": {
                "type": "string",
                "description": "System prompt for this task type"
              }
            }
          },
          "model_specific": {
            "type": "object",
            "description": "Model-specific overrides for this task",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "systemPrompt": {
                  "type": "string",
                  "description": "Model-specific system prompt for this task"
                }
              }
            }
          }
        }
      }
    },
    "spawnable_sub_agent_specialists": {
      "type": "array",
      "description": "Sub-specialists that can be spawned by this specialist",
      "items": {
        "oneOf": [
          {
            "type": "string",
            "description": "Specialist name reference"
          },
          {
            "type": "object",
            "description": "Specialist with additional metadata",
            "required": ["name"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Sub-specialist name"
              },
              "description": {
                "type": "string",
                "description": "What this sub-specialist does"
              },
              "when": {
                "type": "string",
                "description": "When to spawn this sub-specialist"
              }
            }
          }
        ]
      }
    }
  }
}
